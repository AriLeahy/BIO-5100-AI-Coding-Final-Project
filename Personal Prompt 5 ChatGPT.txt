Can you explain each function of this r code